version 1

version 2

version 3

version4 (including the bug fix)